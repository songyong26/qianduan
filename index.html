<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤§ä¼—æŠ•ç¥¨å¹³å°</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- å¤´éƒ¨åŒºåŸŸ -->
        <header class="header">
            <div class="logo-section">
                <div class="logo-icon">ğŸ“¦</div>
                <h1 class="app-title">å¤§ä¼—æŠ•ç¥¨å¹³å°</h1>
            </div>
            <p class="subtitle" id="subtitle">å‚ä¸æŠ•ç¥¨è·å–å¥–åŠ±</p>
            <div class="user-info" id="userInfo" style="display: none;">
                <div class="user-name" id="userName"></div>
                <div class="user-points" id="userPoints" onclick="showPointsDetailModal()" style="cursor: pointer;"></div>
            </div>
            
            <!-- æ“ä½œæŒ‰é’®åŒºåŸŸ -->
            <div class="action-buttons">
                <button class="btn btn-recharge" onclick="showRechargeModal()">å……å¸</button>
                <button class="btn btn-login" id="loginBtn" onclick="handleLogin()">ç™»å½•</button>
                <button class="btn btn-withdraw" onclick="showWithdrawModal()">æå¸</button>
            </div>
        </header>

        <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
        <main class="main-content">
            <!-- æ‰€æœ‰é¡¹ç›®å¡ç‰‡ -->
            <div class="card-container">
                <div class="card-header" onclick="toggleCard('allProjects')">
                    <div class="card-title">
                        <span class="card-icon">ğŸ†</span>
                        <span>æ‰€æœ‰é¡¹ç›®</span>
                    </div>
                    <span class="expand-arrow" id="allProjectsArrow">â–¼</span>
                </div>
                <div class="card-content" id="allProjectsContent">
                    <div id="projectsList"></div>
                </div>
            </div>

            <!-- åˆ›å»ºé¡¹ç›®å¡ç‰‡ -->
            <div class="card-container" id="createProject">
                <div class="card-header" onclick="toggleCard('createProject')">
                    <div class="card-title">
                        <span class="card-icon">ğŸ“</span>
                        <span>åˆ›å»ºé¡¹ç›®</span>
                    </div>
                    <span class="expand-arrow" id="createProjectArrow">â–¼</span>
                </div>
                <div class="card-content" id="createProjectContent">
                    <!-- é‡è¦æé†’ -->
                    <div class="warning-notice">
                        <div class="warning-icon">âš ï¸</div>
                        <div class="warning-content">
                            <strong>é‡è¦æé†’ï¼š</strong>é¡¹ç›®å‘èµ·äººä¸€å®šè¦å…ˆæŸ¥çœ‹<strong>æ¸¸æˆè§„åˆ™</strong>ï¼Œç‰¹åˆ«æ˜¯<strong>"å…³äºå‘å¸ƒé¡¹ç›®"</strong>éƒ¨åˆ†ã€‚é¡¹ç›®ä¸€ç»å‘å¸ƒï¼Œå°†ä¼šä¸¥æ ¼æŒ‰ç…§è§„åˆ™æ‰§è¡Œï¼Œè¿è§„å°†å¯¹ä½ å¸¦æ¥æŸå¤±ï¼
                        </div>
                    </div>
                    <form id="createProjectForm">
                        <div class="form-group">
                            <label for="projectTitle">é¡¹ç›®æ ‡é¢˜ *</label>
                <input type="text" id="projectTitle" placeholder="è¯·è¾“å…¥é¡¹ç›®æ ‡é¢˜ï¼ˆæœ€å¤š11ä¸ªå­—ç¬¦ï¼‰" required>
                        </div>
                        <div class="form-group">
                            <label for="projectDescription">é¡¹ç›®æè¿° (å¯é€‰)</label>
                <textarea id="projectDescription" maxlength="40" placeholder="è¯·è¾“å…¥é¡¹ç›®æè¿°ï¼ˆæœ€å¤š40ä¸ªå­—ç¬¦ï¼‰"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="endTime">æˆªæ­¢æ—¶é—´ *</label>
                            <input type="datetime-local" id="endTime" required>
                        </div>
                        <div class="form-group">
                            <label for="maxPoints">å•ä¸ªé€‰é¡¹æœ€é«˜å¯æŠ•ç§¯åˆ† * (æœ€ä½100ç§¯åˆ†)</label>
                            <input type="number" id="maxPoints" min="100" required>
                        </div>
                        <div class="form-group">
                            <label>æŠ•ç¥¨é€‰é¡¹</label>
                            <div class="vote-options-preview">
                                <div class="vote-option-preview">
                                    <span class="option-text">æ˜¯</span>
                                    <span class="option-description">æ”¯æŒè¯¥é¡¹ç›®</span>
                                </div>
                                <div class="vote-option-preview">
                                    <span class="option-text">å¦</span>
                                    <span class="option-description">åå¯¹è¯¥é¡¹ç›®</span>
                                </div>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">åˆ›å»ºé¡¹ç›®</button>
                    </form>
                </div>
            </div>

            <!-- æˆ‘çš„é¡¹ç›®å¡ç‰‡ -->
            <div class="card-container">
                <div class="card-header" onclick="toggleCard('myProjects')">
                    <div class="card-title">
                        <span class="card-icon">ğŸ“</span>
                        <span>æˆ‘çš„é¡¹ç›®</span>
                    </div>
                    <span class="expand-arrow" id="myProjectsArrow">â–¼</span>
                </div>
                <div class="card-content" id="myProjectsContent">
                    <div class="tab-container">
                        <div class="tab-buttons">
                            <button class="tab-btn active" onclick="switchTab('created')">æˆ‘åˆ›å»ºçš„</button>
                            <button class="tab-btn" onclick="switchTab('participated')">æˆ‘å‚ä¸çš„</button>
                        </div>
                        <div class="tab-content">
                            <div id="createdProjects" class="tab-panel active"></div>
                            <div id="participatedProjects" class="tab-panel"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æ¸¸æˆè§„åˆ™å¡ç‰‡ -->
            <div class="card-container">
                <div class="card-header" onclick="toggleCard('gameRules')">
                    <div class="card-title">
                        <span class="card-icon">ğŸ“‹</span>
                        <span>æ¸¸æˆè§„åˆ™</span>
                    </div>
                    <span class="expand-arrow" id="gameRulesArrow">â–¼</span>
                </div>
                <div class="card-content" id="gameRulesContent">

                    <div class="rules-section">
                        <h3>å…³äºå‘å¸ƒé¡¹ç›®</h3>
                        <ul>
                            <li>ä»»ä½•äººéƒ½å¯ä»¥å‘å¸ƒé¡¹ç›®ï¼Œé¡¹ç›®æœ€ä½è¦æ±‚100ç§¯åˆ†</li>
                            <li>åªè¦ç§¯åˆ†è¶³å¤Ÿä»»ä½•ç”¨æˆ·éƒ½å¯ä»¥å‘å¸ƒé¡¹ç›®ï¼Œä¸éœ€è¦å®¡æ ¸</li>
                            <li>é¡¹ç›®åˆ°æœŸ24å°æ—¶å†…ï¼Œå‘èµ·äººå¿…é¡»å…¬å¸ƒæ­£ç¡®ç»“æœ</li>
                            <li>æœªå‘å¸ƒæ­£ç¡®ç»“æœæŒ‰è¶…æ—¶å¤„ç†ï¼Œç›´æ¥æ‰£é™¤å‘èµ·äººå†»ç»“ç§¯åˆ†çš„60%ï¼Œå…¶å®ƒç”¨æˆ·ç§¯åˆ†åŸè·¯è¿”å›</li>
                            <li>æ•…æ„å…¬å¸ƒé”™è¯¯ç»“æœæŒ‰è¶…æ—¶å¤„ç†ï¼ŒåŒä¸Š</li>
                            <li>å‘å¸ƒé¡¹ç›®ä¹‹å‰è¯·è®¤çœŸæ£€æŸ¥ï¼Œå‘å¸ƒçš„é¡¹ç›®å¿…é¡»è¦æœ‰ç»å¯¹æœ‰æ•ˆçš„ç»“æœ</li>
                            <li>å¦åˆ™é¡¹ç›®åˆ°æœŸåï¼Œä½ å¹¶ä¸èƒ½å…¬å¸ƒæœ‰æ•ˆç»“æœï¼Œä¼šæŸå¤±ä½ çš„ç§¯åˆ†</li>
                        </ul>
                    </div>
                    <div class="rules-section">
                        <h3>å…³äºæŠ•ç¥¨</h3>
                        <ul>
                            <li>å½“ä½ å‚ä¸æŠ•ç¥¨çš„æ—¶å€™ï¼Œé¡¹ç›®å‘èµ·äººå·²ç»å†»ç»“è¶³å¤Ÿçš„ç§¯åˆ†ï¼Œè¯·æ”¾å¿ƒå‚ä¸æŠ•ç¥¨</li>
                            <li>ä¸€æ—¦æŠ•ç¥¨ï¼Œä¸èƒ½æ’¤é”€ï¼Œåªèƒ½ç­‰å¾…é¡¹ç›®å‘èµ·äººå…¬å¸ƒç»“æœï¼Œé¡¹ç›®å¦‚æœè¢«æ’¤é”€ï¼Œä½ çš„ç§¯åˆ†ä¼šåŸè·¯è¿”å›ï¼Œä¸ä¼šæœ‰ä»»ä½•æŸå¤±</li>
                        </ul>
                    </div>
                    <div class="rules-section">
                        <h3>å…³äºå……å€¼å’Œæç°</h3>
                        <ul>
                            <li>ç‚¹å‡»å……å€¼å’Œæç°åæŒ‰ç…§æç¤ºè¾“å…¥å¯¹åº”çš„å†…å®¹ï¼Œæäº¤ç”³è¯·ï¼Œ1å°æ—¶ä¹‹å†…ä¼šå¤„ç†å®Œæ¯•</li>
                        </ul>
                    </div>
                    <div class="rules-section">
                        <h3>å…³äºå‘å¸ƒç»“æœ</h3>
                        <ul>
                            <li>ä¸ºäº†ä¿è¯å‚ä¸æŠ•ç¥¨ç”¨æˆ·çš„åˆç†æƒç›Šï¼Œå‘èµ·äººå…¬å¸ƒç»“æœéœ€è¦æäº¤å®¡æ ¸ï¼Œå®¡æ ¸æ­£å¸¸å°±æ‰¹å‡†å…¬å¸ƒï¼Œå…¬å¸ƒçš„ç»“æœä¸å‡†ç¡®æŒ‰è¶…æ—¶å¤„ç†</li>
                            <li>å…¬å¸ƒç»“æœä¼šåœ¨10åˆ†é’Ÿä¹‹å†…è¿›è¡Œå®¡æ ¸</li>
                        </ul>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Pi Network å……å€¼æ¨¡æ€æ¡† -->
    <div id="rechargeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Pi Network å……å€¼</h2>
                <span class="close" onclick="closeModal('rechargeModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="rechargeForm">
                    <div class="form-group">
                        <label for="rechargeAmount">å……å€¼é‡‘é¢ (Pi) *</label>
                        <input type="number" id="rechargeAmount" min="1" step="1" placeholder="è¯·è¾“å…¥å……å€¼é‡‘é¢" required>
                        <small style="color: rgba(255,255,255,0.7); font-size: 12px;">æœ€ä½å……å€¼é‡‘é¢ï¼š1 Pi</small>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 20px;">ä½¿ç”¨Ï€é’±åŒ…æ”¯ä»˜</button>
                </form>
                <div class="recharge-instructions" style="margin-top: 30px;">
                    <h3>å……å€¼è¯´æ˜ï¼š</h3>
                    <br>
                    <ul>
                        <li><strong>å®‰å…¨æ”¯ä»˜ï¼š</strong>ä½¿ç”¨ Pi Network å®˜æ–¹æ”¯ä»˜ç³»ç»Ÿï¼Œå®‰å…¨å¯é </li>
                        <li><strong>å³æ—¶åˆ°è´¦ï¼š</strong>æ”¯ä»˜å®Œæˆåç§¯åˆ†ç«‹å³åˆ°è´¦</li>
                        <li><strong>æ±‡ç‡å›ºå®šï¼š</strong>1 Pi = 1 ç§¯åˆ†</li>
                        <li><strong>æ”¯ä»˜æµç¨‹ï¼š</strong>ç‚¹å‡»æ”¯ä»˜æŒ‰é’® â†’ Pi é’±åŒ…ç¡®è®¤ â†’ ç§¯åˆ†åˆ°è´¦</li>
                    </ul>

                </div>
            </div>
        </div>
    </div>

    <!-- æç°æ¨¡æ€æ¡† -->
    <div id="withdrawModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>æç°</h2>
                <span class="close" onclick="closeModal('withdrawModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="withdrawForm">
                    <div class="form-group">
                        <label for="withdrawAddress">æå¸åœ°å€ *</label>
                        <input type="text" id="withdrawAddress" pattern="[a-zA-Z0-9]+" title="åªèƒ½è¾“å…¥æ•°å­—å’Œå­—æ¯" required>
                    </div>
                    <div class="form-group">
                        <label for="withdrawAmount">æå¸æ•°é‡ *</label>
                        <input type="number" id="withdrawAmount" min="1" step="1" required>
                        <div class="balance-info">
                            <span>å½“å‰å¯æç°ç§¯åˆ†ï¼š<span id="availableBalance">0</span></span>
                            <div id="frozenPointsInfo" class="frozen-info"></div>
                        </div>
                    </div>
                    <div class="info-section">
                        <p><strong>æç°è¯´æ˜ï¼š</strong></p>
                        <ul>
                            <li>æç°åˆ°è´¦æ—¶é—´ï¼š1å°æ—¶å†…</li>
                            <li>æ‰‹ç»­è´¹ï¼š10%</li>
                            <li><strong>å†»ç»“ç§¯åˆ†åªèƒ½åœ¨è§£å†»åæ‰èƒ½æç°</strong></li>
                            <li>åªèƒ½æç°ä¸è´¦æˆ·ä½™é¢ä¸€è‡´æˆ–ä½äºè´¦æˆ·ä½™é¢çš„æ•´æ•°</li>
                        </ul>
                    </div>
                    <button type="submit" class="btn btn-primary">ç¡®è®¤æç°</button>
                </form>
            </div>
        </div>
    </div>

    <!-- æŠ•ç¥¨æ¨¡æ€æ¡† -->
    <div id="voteModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>æŠ•ç¥¨</h2>
                <span class="close" onclick="closeModal('voteModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div id="voteContent"></div>
            </div>
        </div>
    </div>

    <!-- ç§¯åˆ†æ˜ç»†æ¨¡æ€æ¡† -->
    <div id="pointsDetailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ç§¯åˆ†æ˜ç»†</h2>
                <span class="close" onclick="closeModal('pointsDetailModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="points-summary">
                    <div class="available-points">
                        <span class="points-label">å¯ç”¨ç§¯åˆ†ï¼š</span>
                        <span class="points-value" id="availablePointsDisplay">0</span>
                    </div>
                    <div class="frozen-points">
                        <span class="points-label">å†»ç»“ç§¯åˆ†ï¼š</span>
                        <span class="points-value" id="frozenPointsDisplay">0</span>
                    </div>
                </div>
                <div class="points-history">
                    <h3>ç§¯åˆ†è®°å½•</h3>
                    <div id="pointsHistoryList" class="history-list">
                        <!-- ç§¯åˆ†è®°å½•å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- å…¬å¸ƒç»“æœæ¨¡æ€æ¡† -->
    <div id="publishResultModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>å…¬å¸ƒé¡¹ç›®ç»“æœ</h2>
                <span class="close" onclick="closeModal('publishResultModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div id="publishResultContent">
                    <!-- å†…å®¹å°†åŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </div>
    </div>

    <!-- è‡ªå®šä¹‰å¼¹çª—ç»„ä»¶ -->
    <div id="customAlertModal" class="modal">
        <div class="modal-content custom-alert-modal">
            <div class="modal-header">
                <h2 id="customAlertTitle">æç¤º</h2>
                <span class="close" onclick="closeModal('customAlertModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="custom-alert-content">
                    <div class="custom-alert-icon">â„¹ï¸</div>
                    <div id="customAlertMessage" class="custom-alert-message"></div>
                </div>
                <button class="btn btn-primary custom-alert-btn" onclick="closeModal('customAlertModal')">ç¡®å®š</button>
            </div>
        </div>
    </div>

    <!-- è‡ªå®šä¹‰ç¡®è®¤å¼¹çª—ç»„ä»¶ -->
    <div id="customConfirmModal" class="modal">
        <div class="modal-content custom-confirm-modal">
            <div class="modal-header">
                <h2 id="customConfirmTitle">ç¡®è®¤</h2>
                <span class="close" onclick="closeCustomConfirm(false)">&times;</span>
            </div>
            <div class="modal-body">
                <div class="custom-confirm-content">
                    <div class="custom-confirm-icon">â“</div>
                    <div id="customConfirmMessage" class="custom-confirm-message"></div>
                </div>
                <div class="custom-confirm-buttons">
                    <button class="btn btn-secondary" onclick="closeCustomConfirm(false)">å–æ¶ˆ</button>
                    <button class="btn btn-primary" onclick="closeCustomConfirm(true)">ç¡®å®š</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Pi Network SDK -->
    <script src="https://sdk.minepi.com/pi-sdk.js"></script>
    <script>Pi.init({ version: "2.0" })</script>
    
    <!-- Firebase SDK -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase, ref, set, get, onValue, push, remove, update } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';
        
        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCFo-1e-N9rCacCHrbdMo7IprFtFgHudQ8",
            authDomain: "toupiao-f2403.firebaseapp.com",
            databaseURL: "https://toupiao-f2403-default-rtdb.asia-southeast1.firebasedatabase.app/",
            projectId: "toupiao-f2403",
            storageBucket: "toupiao-f2403.firebasestorage.app",
            messagingSenderId: "450957680225",
            appId: "1:450957680225:web:4b5a0734c97825b5f7d420",
            measurementId: "G-84Q8J3ET07"
        };
        
        // Initialize Firebase
        const firebaseApp = initializeApp(firebaseConfig);
        const database = getDatabase(firebaseApp);
        
        // Make Firebase available globally
        window.firebase = {
            database,
            ref,
            set,
            get,
            onValue,
            push,
            remove,
            update
        };
        
        // Load the main app after Firebase is initialized
        const script = document.createElement('script');
        script.src = 'app.js';
        document.head.appendChild(script);
    </script>
</body>
</html>